function checkForDarkPattern(){"www.google.com"===window.location.hostname&&"/"===window.location.pathname&&reportDarkPattern("Google Homepage","This is a test popup for the Google homepage.")}function reportDarkPattern(t,e){const n=document.createElement("div");n.style.position="fixed",n.style.left="50%",n.style.top="50%",n.style.transform="translate(-50%, -50%)",n.style.padding="20px",n.style.backgroundColor="white",n.style.border="1px solid black",n.style.zIndex="10000",n.textContent=`Dark Pattern Detected: ${t} - ${e}`,document.body.appendChild(n)}function detectTrickQuestions(){document.querySelectorAll("label, .question").forEach((t=>{t.textContent.includes("Wouldn't you prefer to")&&reportDarkPattern("Trick Questions",t.textContent)}))}function detectSneakIntoBasket(){const t=new Set;setInterval((()=>{document.querySelectorAll(".cart-item").forEach((e=>{t.has(e)||"none"===e.style.display||(t.add(e),reportDarkPattern("Sneak into Basket","New item added to your cart unexpectedly."))}))}),1e3)}function detectHiddenCosts(){document.querySelectorAll("price, .cost, .total").forEach((t=>{(t.textContent.includes("price")||t.textContent.includes("not included"))&&reportDarkPattern("Hidden Costs",t.textContent)}))}function detectFreeTrials(){document.querySelectorAll('input[type="text"][name*="credit"], input[type="text"][name*="card"]').forEach((t=>{const e=t.closest("form");e&&/free trial/i.test(e.textContent)&&/automatically renew/i.test(e.textContent)&&reportDarkPattern("Free Trial with Auto-Renewal","This site may automatically charge you after a free trial.")}))}function detectCancellationIssues(){document.querySelectorAll('button, input[type="submit"]').forEach((t=>{(/sign up/i.test(t.textContent)||/register/i.test(t.textContent))&&console.log("Signup found. Check for cancellation terms manually.")}))}function detectMisleadingDownloads(){document.querySelectorAll(".download-button, .download-link").forEach((t=>{t.textContent.includes("Download Now")&&t.closest(".ad, .sponsored")&&reportDarkPattern("Misleading Download Button","This download button may lead to unwanted software.")}))}function detectDisguisedAds(){document.querySelectorAll("article, .news-item").forEach((t=>{t.querySelector(".sponsored, .ad-label")&&reportDarkPattern("Disguised Ads","This ad is styled like a news article.")}))}function detectConfirmshaming(){document.querySelectorAll(".popup, .modal, .overlay").forEach((t=>{(/don't miss out/i.test(t.textContent)||/you'll regret/i.test(t.textContent))&&reportDarkPattern("Confirmshaming","This site uses emotional manipulation to encourage subscriptions.")}))}function reportDarkPattern(t,e){chrome.runtime.sendMessage({darkPatternDetected:!0,patternType:t,detail:e})}function detectDarkPatterns(){detectTrickQuestions(),detectSneakIntoBasket(),detectHiddenCosts(),detectConfirmshaming(),detectDisguisedAds(),detectMisleadingDownloads(),detectCancellationIssues(),detectFreeTrials()}window.addEventListener("DOMContentLoaded",checkForDarkPattern),window.onload=detectDarkPatterns;